{% extends 'base.html.twig' %}

{% block title %}Injection Flaw{% endblock %}

{% block body %}
<h3 class="header">Query Output</h3>

<table>
    <tr>
        <th>Id</th>
        <th>Purchase amount</th>
    </tr>
    {% for item in purchases %}
        <tr>
            <td>{{ item.id }}</td>
            <td>${{ item.amount }}</td>
        </tr>
    {% endfor %}
</table>

<h3 class="header">Code</h3>
{{ hl.hl(code)|raw }}

<h3 class="header">Links</h3>

<div class="collection">
    <a href="{{ path('injection', { userId: '1' }) }}" class="collection-item">Example</a>
    <a href="{{ path('injection', { userId: '1 or 1' }) }}" class="collection-item">Exploit: all purchases</a>
    <a href="{{ path('injection_fixed', { userId: '1 or 1' }) }}" class="collection-item">Fixed</a>
</div>
{% endblock %}
